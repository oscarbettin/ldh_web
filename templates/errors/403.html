{% extends 'base.html' %}

{% block title %}Acceso Denegado{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center mt-5">
        <div class="col-md-6 text-center">
            <i class="bi bi-shield-x text-danger" style="font-size: 5rem;"></i>
            <h1 class="mt-4">403 - Acceso Denegado</h1>
            <p class="lead text-muted">
                No tiene permisos para acceder a esta pÃ¡gina o realizar esta acciÃ³n.
            </p>
            <p>
                Si cree que deberÃ­a tener acceso, contacte al administrador del sistema.
            </p>
            <div class="mt-4">
                <a href="{{ url_for('dashboard.index') }}" class="btn btn-primary">
                    <i class="bi bi-house"></i> Volver al Dashboard
                </a>
                <a href="javascript:history.back()" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Volver AtrÃ¡s
                </a>
            </div>
            {% if current_user.is_authenticated %}
            <div class="mt-4">
                <small class="text-muted">
                    Usuario actual: <strong>{{ current_user.nombre_completo }}</strong><br>
                    Rol: <strong>{{ current_user.rol.nombre }}</strong>
                </small>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
// Cargar el script de asistente_chat.js para tener acceso a activarInputSinPermiso
if (typeof activarInputSinPermiso === 'undefined') {
    const script = document.createElement('script');
    script.src = "{{ url_for('static', filename='js/asistente_chat.js') }}";
    script.onload = function() {
        console.log('âœ… Script asistente_chat.js cargado en 403');
        // Activar input "Sin Permiso" cuando se muestra error 403
        setTimeout(function() {
            if (typeof activarInputSinPermiso === 'function') {
                console.log('ðŸ”’ Error 403 detectado, activando input "Sin Permiso"');
                activarInputSinPermiso(true);
            }
        }, 2000); // Esperar 2 segundos para que RIVE se cargue completamente
    };
    document.head.appendChild(script);
} else {
    // Si ya estÃ¡ cargado, activar directamente
    setTimeout(function() {
        if (typeof activarInputSinPermiso === 'function') {
            console.log('ðŸ”’ Error 403 detectado, activando input "Sin Permiso"');
            activarInputSinPermiso(true);
        }
    }, 1000);
}
</script>
{% endblock %}

