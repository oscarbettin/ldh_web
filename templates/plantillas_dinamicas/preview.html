{% extends "base.html" %}

{% block title %}Vista Previa - {{ protocolo.numero_protocolo }}{% endblock %}

{% block extra_css %}
<style>
.preview-container {
    background: white;
    padding: 40px;
    max-width: 800px;
    margin: 0 auto;
    font-family: 'Times New Roman', serif;
    line-height: 1.6;
}

.header-info {
    text-align: center;
    border-bottom: 2px solid #333;
    padding-bottom: 20px;
    margin-bottom: 30px;
}

.descripcion-section {
    margin-bottom: 30px;
}

.descripcion-item {
    margin-bottom: 15px;
}

.descripcion-label {
    font-weight: bold;
    margin-bottom: 5px;
}

.descripcion-texto {
    text-indent: 20px;
    margin-left: 20px;
}

@media print {
    .no-print {
        display: none;
    }
    
    .preview-container {
        padding: 0;
        box-shadow: none;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="preview-container">
    <div class="no-print mb-3">
        <a href="{{ url_for('protocolos.ver', id=protocolo.protocolo_id) }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Volver al Protocolo
        </a>
        <button onclick="window.print()" class="btn btn-primary ms-2">
            <i class="bi bi-printer"></i> Imprimir
        </button>
    </div>

    <div class="header-info">
        <h2>LABORATORIO DE DIAGNÓSTICO HISTOPATOLÓGICO</h2>
        <h4>INFORME DE CITOLOGÍA CÉRVICO VAGINAL</h4>
        <hr>
        <div class="row">
            <div class="col-md-6">
                <strong>PROTOCOLO:</strong> {{ protocolo.numero_protocolo }}
            </div>
            <div class="col-md-6">
                <strong>FECHA:</strong> {{ protocolo.fecha_ingreso.strftime('%d/%m/%Y') }}
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-md-6">
                <strong>PACIENTE:</strong> {{ protocolo.afiliado.nombre_completo }}
            </div>
            <div class="col-md-6">
                <strong>EDAD:</strong> {{ protocolo.afiliado.edad }} años
            </div>
        </div>
        {% if protocolo.afiliado.obra_social %}
        <div class="row mt-2">
            <div class="col-md-12">
                <strong>OBRA SOCIAL:</strong> {{ protocolo.afiliado.obra_social.nombre }}
            </div>
        </div>
        {% endif %}
    </div>

    <div class="descripcion-section">
        <h4>DESCRIPCIÓN CITOLÓGICA</h4>
        <hr>
        
        {% for seccion, texto in texto_final.items() %}
        <div class="descripcion-item">
            <div class="descripcion-label">{{ seccion }}:</div>
            <div class="descripcion-texto">{{ texto }}</div>
        </div>
        {% endfor %}
    </div>

    <div class="text-center mt-5">
        <p><strong>Dr. Oscar R. Bettin</strong><br>
        Médico Patólogo<br>
        M.P. 12345</p>
    </div>
</div>
{% endblock %}
